<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>HeriLand — Tabs + Settings</title>

  <!-- 你的 CSS（沿用現有 app.css） -->
  <link rel="stylesheet" href="css/app.css"/>
  <link rel="stylesheet" href="css/explore.css"/>
  <link rel="stylesheet" href="css/add.css"/>
</head>
<body>

  <!-- 頂部：品牌 + 齒輪 -->
  <header class="header">
    <div class="inner">
      <div class="brand">HeriLand</div>
      <div class="header-actions" style="display:flex;align-items:center;gap:10px">
        <small style="font-size:12px;color:#6b7280">Testing</small>
        <button id="btnOpenSettings" class="icon-btn" aria-label="Settings" title="Settings">⚙︎</button>
      </div>
    </div>
  </header>

  <main id="app">
    <!-- ====== 主頁們（單頁多分頁） ====== -->

    <!-- Home -->
    <section data-page="home" aria-labelledby="h-home" class="section">
      <h1 id="h-home" data-focusable-heading>Home</h1>
      <p>這裡放首頁內容（hero / chips / rows）。</p>
      <div class="card">一些卡片內容…</div>
    </section>

    <!-- Explore -->
<section data-page="explore" aria-labelledby="h-explore" class="section" hidden>
  <h1 id="h-explore" data-focusable-heading>Explore</h1>

  <!-- 城市牆：固定 4 x 3（由 JS 注入） -->
  <div class="citywall" role="tablist" aria-label="Cities" id="cityWall">
    <button class="citycell" role="tab" aria-selected="true">
      <span class="ico">🏛️</span>
      <span class="name">Kuching</span>
    </button>
  </div>

  <!-- 輕量篩選列：只留 Sort / Open / Filter -->
  <div class="filters" id="expFilters" aria-label="Filters">
    <div class="chips chips--quick" role="group" aria-label="Quick filters">
      <button class="chip" data-sort="latest" aria-pressed="true">⏱️ <span>Latest</span></button>
      <button class="chip" data-sort="hot" aria-pressed="false">🔥 <span>Hot</span></button>
      <button class="chip" data-open="true" aria-pressed="false">🟢 <span>Open now</span></button>
      <button class="chip chip--primary" id="btnOpenFilter">🎯 <span>Filter</span></button>
    </div>
  </div>

  <!-- 已套用條件摘要（JS 生成 chips，可逐一清除） -->
  <div id="activeFilters" class="active-filters" hidden></div>

  <!-- 這個是給 explore.js 用的狀態字串（隱藏即可） -->
  <div id="resultHead" class="sr-only">Pick a city above</div>

  <!-- 骨架 -->
  <div class="skeleton-list" id="skList" hidden>
    <div class="sk-row"></div><div class="sk-row"></div><div class="sk-row"></div>
    <div class="sk-row"></div><div class="sk-row"></div><div class="sk-row"></div>
  </div>

  <!-- 空狀態 -->
  <div class="empty-state" id="emptyState" hidden>
    <div class="empty-emoji">🫙</div>
    <div class="empty-title">No places yet</div>
    <div class="empty-sub">Try another city or check back later.</div>
  </div>

  <!-- 錯誤狀態 -->
  <div class="error-state" id="errorState" hidden role="alert">
    <div class="err-emoji">😵</div>
    <div class="err-title">Failed to load</div>
    <div class="err-sub">Please check your connection and try again.</div>
    <button class="err-retry" id="btnRetry">Retry</button>
  </div>

  <!-- 實際清單 -->
  <div class="merchant-list" id="merchantList" hidden></div>
</section>

<!-- Advanced Filters Drawer -->
<section id="advFilter" class="overlay-page tertiary" hidden aria-labelledby="h-advfilter">
  <header class="subappbar settings-header">
    <button class="icon-btn back" id="btnAdvClose" aria-label="Close">←</button>
    <h1 id="h-advfilter" class="settings-title" tabindex="-1">Filters</h1>
  </header>

  <div class="settings-panel">
    <!-- Categories（多選） -->
    <h3 class="set-overline">Categories</h3>
    <div class="chips" id="afCats">
      <button class="chip" data-cat="Taste">🍽️ <span>Taste</span></button>
      <button class="chip" data-cat="Nature">🏖️ <span>Nature</span></button>
      <button class="chip" data-cat="Culture">🏛️ <span>Culture</span></button>
      <button class="chip" data-cat="Stay">🏠 <span>Stay</span></button>
      <button class="chip" data-cat="Local">🛍️ <span>Local</span></button>
      <button class="chip" data-cat="Experience">💡 <span>Experience</span></button>
    </div>

    <!-- Themes（多選） -->
    <h3 class="set-overline">Themes</h3>
    <div class="chips" id="afThemes">
      <button class="chip" data-theme="Market">Market</button>
      <button class="chip" data-theme="Heritage">Heritage</button>
      <button class="chip" data-theme="Sunset">Sunset</button>
      <button class="chip" data-theme="Family">Family</button>
      <button class="chip" data-theme="Instagram">Instagram</button>
    </div>

    <!-- Attributes（多選） -->
    <h3 class="set-overline">Attributes</h3>
    <div class="chips" id="afAttrs">
      <button class="chip" data-attr="Halal">Halal</button>
      <button class="chip" data-attr="Vegan">Vegan</button>
      <button class="chip" data-attr="Pet-friendly">Pet-friendly</button>
      <button class="chip" data-attr="Wheelchair">Wheelchair</button>
      <button class="chip" data-attr="Parking">Parking</button>
      <button class="chip" data-attr="Wi-Fi">Wi-Fi</button>
    </div>

    <!-- 開放中 / 評分 / 價位 / 排序 -->
    <h3 class="set-overline">More</h3>
    <div class="chips" id="afMore">
      <button class="chip" data-open="true">🟢 Open now</button>
      <button class="chip" data-rating="4.5">⭐ 4.5+</button>
      <button class="chip" data-rating="4.0">⭐ 4.0+</button>
      <button class="chip" data-price="1">$</button>
      <button class="chip" data-price="2">$$</button>
      <button class="chip" data-price="3">$$$</button>
      <button class="chip" data-price="4">$$$$</button>
    </div>

    <h3 class="set-overline">Sort</h3>
    <div class="chips" id="afSort">
      <button class="chip" data-sort="latest">Latest</button>
      <button class="chip" data-sort="hot">Hot</button>
      <button class="chip" data-sort="rating">Rating</button>
    </div>

    <div class="filter-footer">
  <button class="chip" id="btnAdvReset">Reset</button>
  <button class="chip chip--primary" id="btnAdvApply">Apply</button>
</div>
  </div>
</section>

<!-- ===================== Detail Page ===================== -->
<section data-page="detail" class="detail" hidden aria-labelledby="detailName">
  <!-- Sticky AppBar -->
  <header class="d-appbar">
    <button id="btnDetailBack" class="icon-btn" aria-label="Back">←</button>
    <h1 class="d-title" id="detailName">Loading…</h1>
    <div class="d-actions">
      <button id="actShare" class="icon-btn" title="Share" aria-label="Share">🔗</button>
      <button class="icon-btn" title="Favorite" aria-label="Favorite">♡</button>
    </div>
  </header>

  <!-- Scroll area -->
  <div class="d-scroll">
    <!-- Hero Gallery（目前單張，之後可擴充多張橫滑） -->
    <section class="d-hero">
      <div id="detailHero" class="d-hero-photo" aria-hidden="true"></div>
      <div class="d-hero-over">
        <div class="d-subrow">
          <span id="detailCategory" class="d-cat">—</span>
          <span id="detailDot" class="dot">·</span>
          <span id="detailAddress" class="d-area">—</span>
        </div>
        <div id="detailBadges" class="d-badges">
          <!-- JS 注入：★ 4.6、Open now、$$ 等 -->
        </div>
      </div>
    </section>

    <!-- Quick actions -->
    <nav class="d-quick">
      <a id="actPhone" aria-disabled="true"><i>📞</i><span>Call</span></a>
      <a id="actWeb"   aria-disabled="true"><i>🌐</i><span>Website</span></a>
      <a id="actMap"   aria-disabled="true"><i>🗺️</i><span>Map</span></a>
    </nav>

    <!-- About -->
    <section class="d-card">
      <h2 class="d-h2">About</h2>
      <p id="detailDesc" class="d-desc">—</p>
    </section>

    <!-- Hours / Meta -->
    <section class="d-card d-meta">
      <div class="d-meta-col">
        <div class="d-kv">
          <div class="k">Status</div>
          <div id="detailOpen" class="v">—</div>
        </div>
        <div class="d-kv">
          <div class="k">Rating</div>
          <div id="detailRating" class="v">—</div>
        </div>
      </div>
      <div class="d-meta-col">
        <div class="d-kv">
          <div class="k">Price</div>
          <div id="detailPrice" class="v">—</div>
        </div>
      </div>
    </section>

    <!-- Location（可放嵌入地圖；目前留白卡） -->
<section class="d-card">
  <div class="d-head-row">
    <h2 class="d-h2">Location</h2>
    <a id="actMap2" class="link-inline" aria-label="Open in Maps">Open in Maps</a>
  </div>
  <div class="d-mapbox" aria-hidden="true">
    <div class="d-mapph">Map preview</div>
  </div>
</section>

    <!-- Related -->
    <section class="d-card">
      <h2 class="d-h2">You may also like</h2>
      <div id="detailRecList" class="d-related">
        <!-- JS 注入 -->
      </div>
    </section>

    <div class="d-safe"></div>
  </div>
</section>


    <!-- Map -->
    <section data-page="map" aria-labelledby="h-map" class="section" hidden>
      <h1 id="h-map" data-focusable-heading>Map</h1>
      <p>地圖容器（此頁可維持自身狀態）。</p>
      <div class="card">地圖 placeholder</div>
    </section>

    <!-- Saved -->
    <section data-page="saved" aria-labelledby="h-saved" class="section" hidden>
      <h1 id="h-saved" data-focusable-heading>Saved</h1>
      <p>收藏與清單。</p>
      <div class="card">收藏清單</div>
    </section>

    <!-- Add (Creator) -->
<section data-page="add" class="section" hidden>
  <h1 data-focusable-heading>Add</h1>

  <form id="addForm">
    <div class="field">
      <label for="fName">Name *</label>
      <input id="fName" class="input" placeholder="Brilliant Creative Florist" required>
    </div>

    <div class="field">
      <label for="fCity">City *</label>
      <select id="fCity" class="select">
        <option value="">Select a city</option>
        <option value="kuching">Kuching</option>
        <option value="miri">Miri</option>
        <option value="sibu">Sibu</option>
        <!-- …其餘城市 -->
      </select>
    </div>

    <div class="field">
      <label>Category *</label>
      <div id="catChips" class="chips">
        <button type="button" class="chip" data-cat="Taste">🍽️ Taste</button>
        <button type="button" class="chip" data-cat="Nature">🏖️ Nature</button>
        <button type="button" class="chip" data-cat="Culture">🏛️ Culture</button>
        <button type="button" class="chip" data-cat="Stay">🏠 Stay</button>
        <button type="button" class="chip" data-cat="Local">🛍️ Local</button>
        <button type="button" class="chip" data-cat="Experience">💡 Experience</button>
      </div>
    </div>

    <div class="field">
      <label>Themes (optional)</label>
      <div id="themeChips" class="chips">
        <button type="button" class="chip" data-theme="Market">Market</button>
        <button type="button" class="chip" data-theme="Heritage">Heritage</button>
        <button type="button" class="chip" data-theme="Family">Family</button>
        <button type="button" class="chip" data-theme="Instagram">Instagram</button>
      </div>
    </div>

    <div class="field">
      <label>Attributes (optional)</label>
      <div id="attrChips" class="chips">
        <button type="button" class="chip" data-attr="Halal">Halal</button>
        <button type="button" class="chip" data-attr="Vegan">Vegan</button>
        <button type="button" class="chip" data-attr="Parking">Parking</button>
        <button type="button" class="chip" data-attr="Wi-Fi">Wi-Fi</button>
      </div>
    </div>

    <div class="field">
      <label for="fAddress">Address</label>
      <input id="fAddress" class="input" placeholder="Market Rd., Sibu">
    </div>

    <div class="field" style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
      <div>
        <label for="fLat">Lat</label>
        <input id="fLat" class="input" inputmode="decimal" placeholder="2.287">
      </div>
      <div>
        <label for="fLng">Lng</label>
        <input id="fLng" class="input" inputmode="decimal" placeholder="111.827">
      </div>
    </div>

    <div class="field">
      <label for="fPhone">Phone</label>
      <input id="fPhone" class="input" placeholder="+60 …">
    </div>

    <div class="field">
      <label for="fWebsite">Website</label>
      <input id="fWebsite" class="input" type="url" placeholder="https://…">
    </div>

    <div class="field" style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
      <div>
        <label for="fPrice">Price</label>
        <select id="fPrice" class="select">
          <option value="">—</option>
          <option value="1">$</option>
          <option value="2">$$</option>
          <option value="3">$$$</option>
          <option value="4">$$$$</option>
        </select>
      </div>
      <div>
        <label for="fRating">Rating</label>
        <input id="fRating" class="input" type="number" min="0" max="5" step="0.1" placeholder="4.5">
      </div>
    </div>

    <div class="field">
      <label for="fHours">Hours (simple)</label>
      <input id="fHours" class="input" placeholder="09:00-18:00 / 24H">
    </div>

    <div class="field">
      <label for="fDesc">Description</label>
      <textarea id="fDesc" class="textarea" placeholder="Write something…"></textarea>
    </div>

    <div class="field">
      <label for="fCoverUrl">Cover URL</label>
      <input id="fCoverUrl" class="input" type="url" placeholder="https://…/image.jpg">
    </div>

    <div class="field">
      <label for="fImagesUrls">Images URLs (one per line)</label>
      <textarea id="fImagesUrls" class="textarea" placeholder="https://…/1.jpg&#10;https://…/2.jpg"></textarea>
    </div>

    <div class="field">
      <label for="fPhotos">Local preview only (optional)</label>
      <input id="fPhotos" class="input" type="file" accept="image/*" multiple>
      <div id="previewGrid"></div>
    </div>

    <div class="form-actions">
      <button id="btnReset" type="button" class="btn">Reset</button>
      <button id="btnSave"  type="submit" class="btn primary">Save</button>
    </div>

    <div id="toast" role="status" aria-live="polite"></div>
  </form>
</section>




    <!-- ====== Settings（二級） ====== -->
    <section id="p-settings" class="overlay-page" hidden aria-labelledby="h-settings" data-page="settings">
      <header class="subappbar settings-header">
        <button class="icon-btn back" id="btnSettingsBack" aria-label="Back">←</button>
        <h1 id="h-settings" class="settings-title" tabindex="-1">Settings</h1>
      </header>

      <!-- MY ACTIVITY 一張卡 -->
      <div class="set-section">
        <h2 class="set-overline">MY ACTIVITY</h2>
        <div class="set-groupcard">
          <div class="activity-row">
            <button class="activity-btn">Creator</button>
            <button class="activity-btn">Favorites</button>
            <button class="activity-btn">Drafts</button>
          </div>
        </div>
      </div>

      <!-- PREFERENCES 一張卡 -->
      <div class="set-section">
        <h2 class="set-overline">PREFERENCES</h2>
        <div class="set-groupcard">
          <button class="set-item" data-target="settings-language" role="listitem" aria-controls="settings-language">
            <span class="label">Language</span><span class="value">English</span><span class="chev">›</span>
          </button>
          <button class="set-item" data-target="settings-currency" role="listitem" aria-controls="settings-currency">
            <span class="label">Currency</span><span class="value">USD</span><span class="chev">›</span>
          </button>
          <div class="set-item" role="listitem" aria-live="polite">
            <span class="label">Time Format</span><span class="value">24h</span>
          </div>
          <div class="set-item" role="listitem">
            <span class="label">Dark Mode</span>
            <label class="switch"><input type="checkbox" id="toggleDark"/><i></i></label>
          </div>
        </div>
      </div>

      <!-- PRIVACY 一張卡 -->
      <div class="set-section">
        <h2 class="set-overline">PRIVACY</h2>
        <div class="set-groupcard">
          <button class="set-item" data-target="settings-privacy" role="listitem" aria-controls="settings-privacy">
            <span class="label">Privacy</span><span class="chev only">›</span>
          </button>
          <div class="set-item" role="listitem">
            <span class="label">Accessibility</span>
            <label class="switch"><input type="checkbox" id="toggleA11y"/><i></i></label>
          </div>
        </div>
      </div>

      <!-- ABOUT 一張卡 -->
      <div class="set-section">
        <h2 class="set-overline">ABOUT</h2>
        <div class="set-groupcard">
          <div class="set-item" role="listitem">
            <span class="label">Version</span><span class="value">v1.0.0</span>
          </div>
          <button class="set-item" data-target="settings-policy" role="listitem" aria-controls="settings-policy">
            <span class="label">Policy</span><span class="chev only">›</span>
          </button>
        </div>
      </div>
    </section>

    <!-- ====== Settings 第三級（通用樣板） ====== -->
    <section id="settings-language" class="overlay-page tertiary" hidden aria-labelledby="h-language">
      <header class="subappbar settings-header">
        <button class="icon-btn back sub-back" aria-label="Back">←</button>
        <h1 id="h-language" class="settings-title" tabindex="-1">Language</h1>
      </header>
      <div class="settings-panel">
        <button class="option">English</button>
        <button class="option">繁體中文</button>
        <button class="option">Bahasa Melayu</button>
      </div>
    </section>

    <section id="settings-currency" class="overlay-page tertiary" hidden aria-labelledby="h-currency">
      <header class="subappbar settings-header">
        <button class="icon-btn back sub-back" aria-label="Back">←</button>
        <h1 id="h-currency" class="settings-title" tabindex="-1">Currency</h1>
      </header>
      <div class="settings-panel">
        <button class="option">USD</button>
        <button class="option">MYR</button>
        <button class="option">SGD</button>
      </div>
    </section>

    <section id="settings-privacy" class="overlay-page tertiary" hidden aria-labelledby="h-privacy">
      <header class="subappbar settings-header">
        <button class="icon-btn back sub-back" aria-label="Back">←</button>
        <h1 id="h-privacy" class="settings-title" tabindex="-1">Privacy</h1>
      </header>
      <div class="settings-panel">
        <p class="copy">Your privacy matters. (Placeholder)</p>
      </div>
    </section>

    <section id="settings-policy" class="overlay-page tertiary" hidden aria-labelledby="h-policy">
      <header class="subappbar settings-header">
        <button class="icon-btn back sub-back" aria-label="Back">←</button>
        <h1 id="h-policy" class="settings-title" tabindex="-1">Policy</h1>
      </header>
      <div class="settings-panel">
        <p class="copy">Terms & Policy (Placeholder)</p>
      </div>
    </section>
  </main>
  

  <!-- 底部導覽：由 partial 注入 -->
  <div data-include="partials/tabbar.html"></div>

  <!-- scripts：先載入 include，再載入 app（確保綁到已注入的 tab） -->
  <script src="js/include.js" defer></script>
  <script type="module" src="js/app.js"></script>
  <script type="module" src="js/add.js"></script>
  <script type="module" src="js/explore.js"></script>
</body>
</html>












