4/* ===========================
   HeriLand — Tabbar (Glow Capsule)
   适配 iOS/Android，含安全区 & 暗色模式
   =========================== */
:root{
  --tb-height: 62px;                  /* 可换成 56/60 以更紧凑 */
  --tb-radius: 18px;                  /* 胶囊圆角 */
  --tb-maxw: 760px;                   /* 中心容器最大宽度 */
  --tb-bg: rgba(15, 23, 42, .55);     /* 胶囊半透明底色（深蓝灰） */
  --tb-blur: 14px;                    /* 磨砂强度 */
  --tb-border: rgba(255,255,255,.10); /* 胶囊边线 */
  --tb-shadow: 0 10px 35px rgba(0,0,0,.22);
  --tb-ink: rgba(255,255,255,.16);    /* 活跃“墨滴”底胶囊 */
  --tb-ink-border: rgba(255,255,255,.18);
  --tb-ink-shadow: 0 6px 18px rgba(0,0,0,.22);
  --tb-accent: #3ED6A5;               /* 选中主色（文字/图标高亮） */
  --tb-fg: #E7EEF7;                   /* 非激活前景色 */
  --tb-fg-dim: #A7B7C9;
}

/* 固定悬浮条 */
.tabbar{
  position: fixed;
  left: 0; right: 0; bottom: 0;
  z-index: 200;                        /* 覆盖内容，但低于 overlay-sheet 的 4000 */
  display: grid;
  place-items: center;
  padding:
    10px 12px
    calc(env(safe-area-inset-bottom) + 6px);
  pointer-events: auto;
}

/* 半透明背景带毛玻璃（非必要，但更柔和） */
.tabbar .tabbar-bg{
  position: absolute;
  inset: 0;
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  /* 可选：做个很浅的底色罩，提升与页面反差 */
  background: transparent;
}

/* 胶囊容器（不贴边，浮起） */
.tabbar .capsule{
  position: relative;
  width: 100%;
  max-width: var(--tb-maxw);
  height: var(--tb-height);
  border-radius: var(--tb-radius);
  background: var(--tb-bg);
  border: 1px solid var(--tb-border);
  box-shadow: var(--tb-shadow);
  backdrop-filter: blur(var(--tb-blur));
  -webkit-backdrop-filter: blur(var(--tb-blur));
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  align-items: stretch;
  padding: 6px;
  overflow: hidden;
}

/* 活跃“墨滴/底胶囊” — JS 会更新位置/宽度时更顺滑 */
.tabbar .ink{
  position: absolute;
  bottom: 6px; top: 6px;
  left: 6px; width: calc(25% - 6px);   /* 没有 JS 时的稳态：占 1/4 */
  background: var(--tb-ink);
  border: 1px solid var(--tb-ink-border);
  border-radius: calc(var(--tb-radius) - 6px);
  box-shadow: var(--tb-ink-shadow);
  transition: left .24s cubic-bezier(.22,.9,.26,1), width .24s, opacity .24s;
  pointer-events: none;
}

/* 按钮基础：紧凑、居中、无视觉噪点 */
.tabbar .tab{
  appearance: none;
  border: 0;
  background: transparent;
  border-radius: calc(var(--tb-radius) - 6px);
  color: var(--tb-fg-dim);
  display: grid;
  place-items: center;
  gap: 2px;
  grid-template-rows: 1fr auto;       /* 图标占更多垂直空间 */
  padding: 4px 6px;
  cursor: pointer;
  position: relative;
  z-index: 1;                          /* 在 ink 上层 */
  transition: transform .06s ease, color .18s ease;
}
.tabbar .tab:active{ transform: translateY(1px); }

/* 图标与文字比例 */
.tabbar .tab .ico{
  font-size: 18px;
  line-height: 1;
}
.tabbar .tab .txt{
  font-size: 11px;
  letter-spacing: .02em;
  font-weight: 600;
  opacity: .95;
}

/* 激活态（ARIA/类名都兼容） */
.tabbar .tab[aria-selected="true"],
.tabbar .tab.is-active{
  color: var(--tb-fg);
}
.tabbar .tab[aria-selected="true"] .ico,
.tabbar .tab.is-active .ico{
  color: var(--tb-accent);
  text-shadow: 0 0 14px color-mix(in srgb, var(--tb-accent) 35%, transparent);
}

/* 焦点可见：键盘可达 */
.tabbar .tab:focus-visible{
  outline: 2px solid color-mix(in srgb, var(--tb-accent) 60%, white 0%);
  outline-offset: 2px;
}

/* 占位（与 tabbar 高度一致，避免内容被压住） */
.tabbar-spacer{
  height: calc(var(--tb-height) + 16px + env(safe-area-inset-bottom));
}

/* 打开 overlay-sheet 时让 tabbar 下沉（你之前有 .no-scroll） */
.no-scroll .tabbar{
  transform: translateY(110%);
  transition: transform .18s ease;
  pointer-events: none;
}

/* ===== 暗色模式微调（tabbar 已是暗色底，这里调文本层级） ===== */
@media (prefers-color-scheme: dark){
  :root{
    --tb-bg: rgba(6, 10, 14, .55);
    --tb-border: rgba(255,255,255,.08);
    --tb-ink: rgba(255,255,255,.14);
    --tb-ink-border: rgba(255,255,255,.12);
    --tb-fg: #F2F6FB;
    --tb-fg-dim: #B6C4D6;
  }
}

/* ===== 紧凑屏（小机型） ===== */
@media (max-width: 360px){
  :root{ --tb-height: 56px; }
  .tabbar .tab .ico{ font-size: 17px; }
  .tabbar .tab .txt{ font-size: 10.5px; }
}

/* ===== 大屏（平板）提高宽度上限 ===== */
@media (min-width: 820px){
  :root{ --tb-maxw: 880px; }
}

/* ===== 降噪：减少动态效果首选项 ===== */
@media (prefers-reduced-motion: reduce){
  .tabbar .ink{ transition: none; }
  .tabbar .tab{ transition: none; }
}